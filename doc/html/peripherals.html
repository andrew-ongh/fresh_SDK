<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>SmartSnippets DA1468x/DA15xxx SDK: Peripherals demo application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SmartSnippets DA1468x/DA15xxx SDK
   &#160;<span id="projectnumber">Version 1.0.14.1081</span>
   </div>
   <div id="projectbrief">Combo Bluetooth Smart and 802.15.4</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Peripherals demo application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview</h2>
<p>The application is a sample implementation of how various peripherals can be used.</p>
<p>Features:</p>
<ul>
<li>The application can be simply controlled using a text-based menu via UART1,</li>
<li>Some demos (e.g. a UART demo) print debug messages which can be read only via UART2,</li>
<li>The demo checks the usage of almost all available peripherals.</li>
</ul>
<h3>Folder structure</h3>
<table class="doxtable">
<tr>
<th>Top level folders </th><th>Description  </th></tr>
<tr>
<td>sdk/adapters/ </td><td>Adapter implementations </td></tr>
<tr>
<td>app/ </td><td>Application framework, i.e. menu and task management </td></tr>
<tr>
<td>sdk/bsp_include/ </td><td>Common BSP includes </td></tr>
<tr>
<td>config/ </td><td>Configuration of demo applications </td></tr>
<tr>
<td>demos/ </td><td>Demo files (see Demos for detailed description) </td></tr>
<tr>
<td>ldscripts/ </td><td>Linker scripts </td></tr>
<tr>
<td>sdk/osal/ </td><td>OS abstraction layer </td></tr>
<tr>
<td>startup/ </td><td>Startup files </td></tr>
</table>
<table class="doxtable">
<tr>
<th>Config folder contents </th><th>Description  </th></tr>
<tr>
<td>config/default/gpio_setup.h </td><td>Default GPIO pin assignment (see GPIO assignments) </td></tr>
<tr>
<td>config/default/userconfig.h </td><td>Default application configuration (see Suggested configurable parameters) </td></tr>
<tr>
<td>config.h </td><td>Application configuration (should not be modified directly, modify files above instead) </td></tr>
</table>
<table class="doxtable">
<tr>
<th>Demos folder contents </th><th>Description  </th></tr>
<tr>
<td>common.h </td><td>Function prototypes for demo applications </td></tr>
<tr>
<td>periph_setup.c </td><td>Peripherals configuration (i.e. actual GPIO configuration) </td></tr>
<tr>
<td>demo_*.c </td><td>Demo for single peripheral </td></tr>
</table>
<h3>Demos</h3>
<p>Using the peripherals demo it is possible to check how peripherals work (e.g Timers, I2C, QSPI etc.). The features depend on the selected demos which are described below.</p>
<h4>Breath timer demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Breath Timer</li>
<li><b>Source file</b>: demo_breath.c</li>
<li><b>Description:</b> <br />
 The demo presents an automated breathing function for an external LED without software interference.<br />
 There are a few examples of possible configurations to achieve various pulsing schemes. The D1 LED<br />
 located on the board is used by default to present how this peripheral can be used in a practical way.</li>
<li><b>Pin-connections</b>: There is no need to make any additional connections - everything is available on the board.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_BREATH      (1)</span></div>
</div><!-- fragment --> Following macros have to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C     (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_ADXL362 (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Constant dim led</h5>
<p>The LED shines dim.</p>
<h5>Constant bright led</h5>
<p>The LED shines brightly.</p>
<h5>Emergency led</h5>
<p>The LED blinks fast.</p>
<h5>Dim standby breath</h5>
<p>The LED blinks slow.</p>
<h5>Slow standby breath</h5>
<p>The LED lights up slowly.</p>
<h5>Disable breath</h5>
<p>Turn off the LED.</p>
<p>The following configurations on breath timer are used in this example:</p><ul>
<li>PWM duty cycle: the percentage of one period in which signal is active - LED is shining</li>
<li>PWM duty cycle step</li>
<li>PWM frequency: system clock division factor</li>
<li>PWM polarity: positive or negative</li>
</ul>
<h4>General purpose ADC demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: GPADC</li>
<li><b>Source file</b>: demo_gpadc.c</li>
<li><b>Description:</b> <br />
 The demo presents the typical usage of a General Purpose Analog-to-Digital Converter (GPADC) with 10-bit resolution. After calibration there is a possibility to choose an input source, sampling rate. As well as additional features e.g. chopping, oversampling, enabling input attenuator or sign change.</li>
</ul>
<blockquote class="doxtable">
<p>Note: It is advised not to run <b>General Purpose ADC demo</b> and <b>General Purpose ADC adapter demo</b> consecutively. The reason is, that the former uses the low level driver API of the GPADC while the latter the corresponding of the adapter. As a result the GPADC configuration applied by one demo may not be in sync with the other. </p>
</blockquote>
<ul>
<li><b>Pin-connections</b>: The below picture shows to which GPIOs and how external devices should be connected to the board.</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__          SOURCE1___         SOURCE2___         SOURCE3___
   |                 |         |      GND|--.     |      GND|--.     |      GND|--.
   |       GPADC_____|         |         |  |     |         |  |     |         |  |
   |       |     P0_7|&lt;--------|V_OUT____|  |  .--|V_OUT____|  |  .--|V_OUT____|  |
   |       |     P1_2|&lt;---------------------|--'               |  |               |
   |       |     P1_4|&lt;---------------------|------------------|--'               |
   |       `---------|                      |                  |                  |
   |              GND|----------------------o------------------o------------------'
   '-----------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_GPADC       (1)</span></div>
</div><!-- fragment --> Following macros have to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C_ASYNC   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C     (0)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BH1750  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BME280  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMM150  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMG160  (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Configure</h5>
<ul>
<li>Enabling a digital clock turns on an external clock (16 or 96 MHz). If it is disabled then an internal high-speed ADC clock is used.</li>
<li>Input attenuator allows higher input voltage up to +3.6V in a single-ended mode and -3.6V - +3.6V in a differential mode. Disabling it allows voltage up to +1.2V in the single-ended mode and -1.2V - +1.2V in a differential mode.</li>
<li>Chopping function causes the GPADC to take two samples with opposite polarity in each conversion. This is used to cancel an internal offset voltage of the GPADC. It is recommended for DC-measurements.</li>
<li>Sign change enables conversion with an opposite sign at GPADC input and output to cancel out the internal offset of the ADC.</li>
<li>Oversampling provides effectively better measurements precision. The more conversion the better precision.</li>
<li>An interval for continuous mode - a period after which the next conversion will be executed.</li>
</ul>
<h5>Select input</h5>
<p>Set an input for GPADC. The input will be used by GPADC to measure the voltage on it.</p>
<h5>Measure</h5>
<p>Get raw and converted values of measured voltage results.</p>
<h5>Continuous mode</h5>
<p>In continuous mode, GPADC performs conversions at configured intervals automatically.</p>
<h5>Show state</h5>
<p>Print the settings of GPADC.</p>
<h4>General Purpose ADC adapter demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: GPADC</li>
<li><b>Source file</b>: demo_ad_gpadc.c</li>
<li><b>Description:</b> <br />
 The demo shows how a GPADC adapter can be used to manage devices connected to GPADC.</li>
</ul>
<blockquote class="doxtable">
<p>Note: It is advised not to run <b>General Purpose ADC demo</b> and <b>General Purpose ADC adapter demo</b> consecutively. The reason is, that the former uses the low level driver API of the GPADC while the latter the corresponding of the adapter. As a result the GPADC configuration applied by one demo may not be in sync with the other. </p>
</blockquote>
<ul>
<li><b>Pin-connections</b>: The below picture shows to which GPIOs and how external devices should be connected to the board.</li>
</ul>
<pre>
                                 EXAMPLE                        EXAMPLE
   DIALOG_DEV_BOARD__            LIGHT_SENSOR___                ENCODER_SENSOR___
   |                 |           |           GND|--.            |             GND|--.
   |                 |           |              |  |         .--|V_OUT1          |  |
   |                 |        .--|V_OUT_________|  |         |  |V_OUT2__________|  |
   |       GPADC_____|        |                    |         |     |                |
   |       |     P1_2|&lt;-------o--------------------|---------'     |                |
   |       |     P1_4|&lt;----------------------------|---------------'                |
   |       `---------|                             |                                |
   |              GND|-----------------------------o--------------------------------'
   '-----------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_GPADC       (1)</span></div>
</div><!-- fragment --> Following macros have to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C_ASYNC   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C     (0)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BH1750  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BME280  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMM150  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMG160  (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Read battery level</h5>
<p>Read the battery voltage (VBAT).</p>
<h5>Read temperature sensor</h5>
<p>Measure the ambient temperature with the embeeded temperature sensor. The results are displayed in degrees Celsius.</p>
<h5>Read light sensor</h5>
<p>Read the voltage on P1.2 pin (by default), where the value of an external light sensor is measured. The light sensor is only an example here, other different devices can be connected to the same pin to measure their outputs. The P1.2 pin was set as a single-ended input where the value is measured with reference to a ground signal (GND).</p>
<h5>Read encoder sensor</h5>
<p>Encoder sensors are mostly used in counting the motors' rotations. The demo is an example of using inputs set in differential mode. This can be used e.g. to estimate the direction of a motor revolution. In this case the voltage value is measured between the P1.2 and P1.4 pins. The results are printed in mV.</p>
<h4>Temperature sensor adapter demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Embedded temperature sensor</li>
<li><b>Source file</b>: ad_temp_sens.c</li>
<li><b>Description:</b> <br />
 The demo reads the temperature value of the temperature sensor which is embedded into the chip. The results are printed out in a serial terminal in degrees Celsius.</li>
<li><b>Pin-connections</b>: There is no need to make any additional connections - everything is available on the board.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_TEMPSENS      (1)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Read Temperature Sensor</h5>
<p>Read the value of Temperature Sensor synchronously.</p>
<h5>Read Asynchronously Temperature Sensor</h5>
<p>Read the value of Temperature Sensor asynchronously.</p>
<h5>Read Temperature every 5 seconds</h5>
<p>Read the value of Temperature Sensor synchronously every 5 seconds.</p>
<h4>I2C demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: I2C</li>
<li><b>Source file</b>: demo_i2c.c</li>
<li><b>Description:</b> <br />
 The demo presents the usage of I2C interface with the external devices. It shows read/write operations on external temperature sensor and EEPROM memory.</li>
</ul>
<blockquote class="doxtable">
<p>Note: The demo requires an external temperature sensor (FM75) and EEPROM memory (24LC256) devices which have to be connected to the I2C interface (P1.2 - SDA, P3.5 - SCL)!! </p>
</blockquote>
<ul>
<li><b>Pin-connections</b>: The below picture shows to which GPIOs and how external devices should be connected to the board.</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__            TEMP_SENS_FM75_                EEPROM_24LC256___
   |                 |           |           GND|--.            |             GND|--.
   |                 |        .--|SDA           |  |         .--|SDA             |  |
   |                 |        |  |SCL___________|  |         |  |SCL_____________|  |
   |       I2C1______|        |    |               |         |    |                 |
   |       |SDA(P1_2)|&lt;-------o----|---------------|---------'    |                 |
   |       |SCL(P3_5)|&lt;------------o---------------|--------------'                 |
   |       `---------|                             |                                |
   |              GND|-----------------------------o--------------------------------'
   '-----------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C         (1)</span></div>
</div><!-- fragment --> Following macros have to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_GPADC       (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_GPADC       (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2      (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Write data to EEPROM</h5>
<p>Write random data to the EEPROM memory.</p>
<h5>Read data from EEPROM</h5>
<p>Read data which had been written to the memory.</p>
<h5>Set FM75 configuration</h5>
<p>There is a possibility to set:</p><ul>
<li>Sensor resolution to 9, 10, 11 or 12 bit,</li>
<li>An alarm range where it is not activated</li>
</ul>
<h5>Enable temperature sensor</h5>
<p>Toggle on/off reading from the temperature sensor.</p>
<p>The following configurations on I2C are used in this example:</p><ul>
<li>I2C speed: standard, it can be changed to fast</li>
<li>I2C mode: master, which means that the board manages the external devices</li>
<li>I2C addressing mode: 7-bit addressing, there is also possibility to select 10-bit addressing</li>
</ul>
<h4>I2C demo async</h4>
<ul>
<li><b>Demonstrated peripheral</b>: I2C</li>
<li><b>Source file</b>: demo_i2c_async.c</li>
<li><b>Description:</b> <br />
 The demo does exactly the same as I2C demo but this one uses asynchronous write and read operations on external devices, resulting in faster actions.</li>
<li><b>Pin-connections</b>: The same as in I2C demo</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C_ASYNC      (1)</span></div>
</div><!-- fragment --> Following macros have to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_GPADC          (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_GPADC          (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2         (0)</span></div>
</div><!-- fragment --></li>
</ul>
<h4>IR generator demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: InfraRed Generator (IR)</li>
<li><b>Source file</b>: demo_irgen.c</li>
<li><b>Description:</b> <br />
 This is a complete example of how the IR generator can be used to implement the IR transmission protocol. A NEC protocol is used here.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_IRGEN      (1)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Send NEC protocol command</h5>
<p>4 shots - the IR sends NEC command 4 times and stops. Repeat - the IR is sending NEC command repeatedly.</p>
<h5>Stop sending command</h5>
<p>Turn off the IR generator.</p>
<p>The following configurations on InfraRed Generator are used in this example:</p><ul>
<li>IR logic bit format: mark is followed by space</li>
<li>IR FIFO: code and repeat FIFO</li>
<li>Paint symbol: space and mark</li>
<li>Output mode: inverted</li>
</ul>
<h4>Power mode demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Clock-Power manager</li>
<li><b>Source file</b>: demo_power_mode.c</li>
<li><b>Description:</b> <br />
 This is a typical example of using the various sleep modes. Demostrating the platform in sleep mode if the user had previously chosen one of the sleep modes. The platform can be awakened by pressing the K1 button.</li>
<li><b>Pin-connections</b>: There is no need to make any additional connections - everything is available on the board.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_POWER_MODE      (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_WKUP         (0)</span></div>
</div><!-- fragment --> and functional conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_UART         (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear.<ul>
<li>Go to Active Mode</li>
<li>Go to Extended Sleep Mode</li>
<li>Go to Hibernation Mode</li>
</ul>
</li>
</ul>
<p>Expected result:<br />
 If the platform is in an Extended Sleep, a Deep Sleep or a Hibernation Sleep Mode pressing the button wakes it and sets Active Mode. The proper messages about these operations will be printed in a serial terminal. SmartSnippets toolbox power profile or digital current meter can be used to monitor the current changes across the power mode switch.</p>
<h4>Quad SPI demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: QSPI</li>
<li><b>Source file</b>: demo_qspi.c</li>
<li><b>Description:</b> <br />
 The demo presents communication with the FLASH memory by using Quad SPI interface. There are two speeds of data transmission:<ul>
<li>fast (quad mode) - 4 signal lines are used to execute read/write operations,</li>
<li>slow (single mode) - 1 signal line is used to execute read/write operations.</li>
</ul>
</li>
<li><b>Pin-connections</b>: There is no need to make any additional connections - everything is available on the board.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_QSPI        (1)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Set fastest quad mode</h5>
<p>Set fastest data transmission - quad mode.</p>
<h5>Set slowest single mode</h5>
<p>Set slowest data transmission - single mode.</p>
<h5>Test performance</h5>
<p>Copy data from RAM to RAM, ROM to RAM, FLASH to RAM memories, execute it and show the time statistics of the performed operations.</p>
<h5>QSPI divider X</h5>
<p>Divide SPI clock by X divider. It is selected by a user. By default it is set to 1.</p>
<p>The following configurations on QSPI are used in this example:</p><ul>
<li>QSPI address size: flash memory uses 24 bits address</li>
<li>Idle clock state: high state on idle state of the SPI clock</li>
<li>QSPI sampling edge: negative sampling edge</li>
<li>QSPI bus mode: single and quad modes</li>
</ul>
<h4>Quadrature decoder demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Quadrature decoder (QUAD)</li>
<li><b>Source file</b>: demo_quad.c</li>
<li><b>Description:</b> <br />
 Demonstrates automatic signal decoding for the X, Y and Z axes of an externally connected HID device. Step count and direction data are printed in a serial terminal.</li>
<li><b>Pin-connections</b>: The below picture shows to which GPIOs and how external devices should be connected to the board.</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__          HID_DEVICE___
   |       QUAD______|         |            |
   |       | XB(P4_1)|&lt;--------|X2          |
   |       | ZA(P4_2)|&lt;--------|Z1          |
   |       | ZB(P4_3)|&lt;--------|Z2          |
   |       | XA(P4_4)|&lt;--------|X1          |
   |       | YA(P4_6)|&lt;--------|Y1          |
   |       | YB(P4_7)|&lt;--------|Y2          |
   |       `---------|         |            |
   |              GND|---------|GND         |
   '-----------------'         '------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_QUAD      (1)</span></div>
</div><!-- fragment --> Following macros have to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI       (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_AD_SPI_1          (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Enable/disable channel</h5>
<p>Enable/disable channel for X, Y or Z axis.</p>
<h5>Set threshold</h5>
<p>Set threshold to 1, 64 or 127 events. If one of the axes will reach the threshold value an interrupt is generated and current values of steps for each axis are printed in a serial terminal.</p>
<h5>Get channels state</h5>
<p>Print activity state (active or inactive) and number of steps for each axis.</p>
<h4>Sensor demos</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Accelerometer sensor (ADXL362), Environmental sensor (BME280), Geomagnetic sensor (BMM150), Gyroscope sensor (BMG160), Light sensor (BH1750)</li>
<li><b>Source file</b>: demo_sensors.c</li>
<li><b>Description:</b> <br />
 Sensor demos can be activated in userconfig.h. To use sensor demos <code>DA14680_Sensor_Board</code> is needed.</li>
<li><b>Pin-connections</b>: Put DA14680_Sensor_Board on dialog development board and needed connections will be created.</li>
</ul>
<h5>Accelerometer sensor (ADXL362)</h5>
<p>Print raw and converted in 4g range x,y,z axes acceleration using 8 bit and 12 bit resolution.</p>
<ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_ADXL362      (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2           (0)</span></div>
</div><!-- fragment --></li>
</ul>
<p>For following sensors BME280, BMM150, BMG160 and BH1750 the below macros have to be disabled: </p><div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_GPADC            (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_GPADC            (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2           (0)</span></div>
</div><!-- fragment --><h5>Environmental sensor (BME280)</h5>
<p>Print raw and converted (according to a specification) temperature, pressure and humidity measurements.</p>
<ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BME280       (1)</span></div>
</div><!-- fragment --></li>
</ul>
<h5>Geomagnetic sensor (BMM150)</h5>
<p>Print raw and converted compensated magnetometer data (for x,y,z axes) in 16 bit resolution.</p>
<ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMM150       (1)</span></div>
</div><!-- fragment --></li>
</ul>
<h5>Gyroscope sensor (BMG160)</h5>
<p>Print raw and converted gyroscope data (for x,y,z axes) in 16 bit resolution.</p>
<ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMG160       (1)</span></div>
</div><!-- fragment --></li>
</ul>
<h5>Light sensor (BH1750)</h5>
<p>Prints raw and calculated illumination data in 16 bit resolution.</p>
<ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BH1750       (1)</span></div>
</div><!-- fragment --></li>
</ul>
<h4>SPI demo with using OS abstraction layer</h4>
<ul>
<li><b>Demonstrated peripheral</b>: SPI</li>
<li><b>Source file</b>: demo_spi_os.c</li>
<li><b>Description:</b> <br />
 The demo presents the Serial Peripheral Interface (SPI) with a master/slave capability. The demo uses FLASH memory (AT45DB011D) to show basic operations like writing, reading and erasing the memory.</li>
</ul>
<blockquote class="doxtable">
<p>Note: AT45DB011D (FLASH memory) has to be connected externally. It is not placed on the development board! </p>
</blockquote>
<ul>
<li><b>Pin-connections</b>: The below picture shows to which GPIOs and how external devices should be connected to the board.</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__          AT45DB011D______
   |       SPI_______|         |               |
   |       | DO(P3_7)|--------&gt;|SO             |
   |       | DI(P4_0)|&lt;--------|SI             |
   |       |CLK(P4_1)|--------&gt;|SCK            |
   |       | CS(P2_0)|--------&gt;|!CS            |
   |       `---------|         |               |
   |(MASTER)      GND|---------|GND     (SLAVE)|
   '-----------------'         '---------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b>'config/default/userconfig.h'</b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI      (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_BREATH   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_QUAD     (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_UART     (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Write time to AT45DB011D</h5>
<p>Write time (tick time) to the flash.</p>
<h5>Erase log area in AT45DB011D</h5>
<p>Erase page with the results.</p>
<h5>Print log from AT45DB011D</h5>
<p>Read data (time results) written to the flash.</p>
<h4>SPI and I2C demo with using OS abstraction layer</h4>
<ul>
<li><b>Demonstrated peripheral</b>: SPI, I2C</li>
<li><b>Source file</b>: demo_i2c_spi.c</li>
<li><b>Description:</b> <br />
 The demo presents synchronous and asynchronous actions using the SPI and I2C interfaces.</li>
</ul>
<blockquote class="doxtable">
<p>Note: AT45DB011D (FLASH memory) and 24xx256 (EEPROM memory) has to be connected externally. They are not placed on the development board! </p>
</blockquote>
<ul>
<li><b>Pin-connections</b>: The below picture shows to which GPIOs and how external devices should be connected to the board.</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__            AT45DB011D______
   |       SPI_______|           |               |
   |       | DO(P3_7)|----------&gt;|SO             |
   |       | DI(P4_0)|&lt;----------|SI             |
   |       |CLK(P4_1)|----------&gt;|SCK            |
   |       | CS(P2_0)|----------&gt;|!CS            |
   |       `---------|           |               |
   |              GND|-----------|GND     (SLAVE)|
   |(MASTER)         |           '---------------'
   |                 |
   |       I2C_______|           24xx256_________
   |       |SDA(P1_2)|&lt;---------&gt;|SDA            |
   |       |SCL(P3_5)|----------&gt;|SCL            |
   |       `---------|           |               |
   |              GND|-----------|VSS     (SLAVE)|
   '-----------------'           '---------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b>'config/default/userconfig.h'</b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C  (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_BREATH   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2   (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_QUAD     (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_UART     (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Copy from AT45DB011D to 24xx256 [async]</h5>
<p>Depending on a chosen option it copies data from AT45DB011D (SPI) to 24xx256 (I2C) memory synchronously or asynchronously.</p>
<h5>Copy from 24xx256 to AT45DB011D [async]</h5>
<p>Depending on chosen option it copies data from 24xx256 (I2C) to AT45DB011D (SPI) memory synchronously or asynchronously.</p>
<h4>Timer 0 demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Timer0</li>
<li><b>Source file</b>: demo_timer0.c</li>
<li><b>Description:</b> <br />
 The demo presents a general purpose timer with PWM output. There are a few examples of how the timer can be used to blink or dim the D2 LED by using precisely calculated PWM settings.</li>
<li><b>Pin-connections</b>: There is no need to make any additional connections - everything is available on the board.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER0      (1)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Blink LED 4 times</h5>
<p>The LED blinks 4 times and turns off.</p>
<h5>Blink LED 10 times</h5>
<p>The LED blinks 10 times and turns off.</p>
<h5>Blink LED 7 times lower intensity</h5>
<p>The LED blinks 7 times with lower intensity and turns off.</p>
<h5>Set bright LED with PWM 90%</h5>
<p>The LED shines brightly.</p>
<h5>Set bright LED with PWM 20%</h5>
<p>The LED shines dim.</p>
<h5>Low power indicator (short blinks)</h5>
<p>The LED starts generating very short blinks like a power indicator when the battery is low.</p>
<h5>Turn off LED</h5>
<p>Turns off the LED.</p>
<p>The following configurations on timer0 are used in this example:</p><ul>
<li>Clock resource of timer0 : slow 32 kHz clock</li>
<li>PWM mode: full brightness PWM mode or half brightness CLOCK mode that will change duty cycle to 50% when LED is on</li>
<li>Duty cycle: percentage of one period in which a signal or system is active</li>
<li>Reload ON counter to set up the time when timer0 interrupt happens</li>
</ul>
<h4>Timer 1 demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Timer1</li>
<li><b>Source file</b>: demo_timer1.c</li>
<li><b>Description:</b> <br />
 The demo presents a general purpose timer with PWM capability. The timer may count up or down with a 16-bit resolution. There are couple settings how to configure the PWM output. The higher value of frequency and/or duty cycle, the brighter the D2 LED shines.</li>
<li><b>Pin-connections</b>: The picture below shows the GPIOs and how the external devices should be connected to the board or the way that a user can use LED2 which is located on the board (read Timer1 brief section in userconfig.h)</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__
   |                 |
   |       GPIO______|      _____       _____
   |       |     P1_6|--o--|__R__|--o--|A___K|--o--.
   |       `---------|      330R         LED       |
   |                 |                             |
   |              GND|-----------------------------'
   '-----------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER1      (1)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>PWM frequency</h5>
<p>Set the frequency of the PWM signal: 64 Hz, 128 Hz or 256 Hz.</p>
<h5>PWM duty cycle</h5>
<p>Set the duty cycle of the PWM signal: 25%, 50% or 75%.</p>
<blockquote class="doxtable">
<p>Note: In order to apply the settings, the frequency must be set first before setting duty cycle. </p>
</blockquote>
<h4>Timer 2 demo</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Timer2</li>
<li><b>Source file</b>: demo_timer2.c</li>
<li><b>Description:</b> <br />
 The demo presents usage of a 14-bit timer which controls three PWM signals. An external RGB LED is used to show how the timer can be used in a typical situation. Depending on the PWM settings, the LED changes color and brightness. By default the LED should be connected to P3.5, P3.6 and P3.7 pins (inputs can be changed in the <code>config/default/gpio_setup.h</code> file).</li>
<li><b>Pin-connections</b>: The picture below shows the GPIOs and how the external devices should be connected to the board.</li>
</ul>
<pre>
                                         RGB_LED_____
   DIALOG_DEV_BOARD__         _____      |           |
   |                 |  .-o--|__R__|--o--|RED        |
   |       GPIO______|  |     330R       |           |
   |       |     P3_5|--'     _____      |           |
   |       |     P3_6|----o--|__R__|--o--|GREEN      |
   |       |     P3_7|--.     330R       |           |
   |       `---------|  |     _____      |           |
   |                 |  '-o--|__R__|--o--|BLUE       |
   |                 |        330R       |           |
   |                 |                   |           |
   |              GND|-------------------|COMMON     |
   '-----------------'                   '-----------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2      (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C     (0)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_I2C_ASYNC   (0)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BH1750  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BME280  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_ADXL362 (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMM150  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BMG160  (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Set PWMs frequency</h5>
<p>Set the timer frequency to 20kHz, 4 kHz or 250 Hz. The higher frequency the brighter the LED shines.</p>
<h5>Set start/end PWMs duty cycles</h5>
<p>PWM signals are generated with the same period but there is the possibility to manually specify start and end position of high state inside single cycle for each PWM separately. The option shows the PWM duty cycles (25%) which are shifted beetwen themselves. It causes the LED to change the color fluently.</p>
<h5>Light RGB LED</h5>
<p>Turn on the LED with chosen color (Grey, Orange, Violet, Yellow, Magenta or Cyan).</p>
<h5>PWMs state</h5>
<p>Print information about the frequency and duty cycles of each PWM signal.</p>
<h5>Pause timer</h5>
<p>Pause/Resume the timer, i.e. toggle on/off the LED. If option is checked then timer is paused.</p>
<p>The following configurations on timer2 are used in this example:</p><ul>
<li>Division factor: use to divide the main frequency (16 MHz) to smaller values to slow the timing</li>
<li>3 PWM's are used with different start/end duty cycles</li>
</ul>
<h4>UART demo with using OS abstraction layer</h4>
<ul>
<li><b>Demonstrated peripheral</b>: UART</li>
<li><b>Source file</b>: demo_uart_os.c</li>
<li><b>Description:</b> <br />
 The demo presents concurrent access to UART from two tasks. It uses UART locking system to properly handle the concurrent access from the different tasks.</li>
<li><b>Pin-connections</b>: The picture below shows the GPIOs and how the external devices should be connected to the board.</li>
</ul>
<pre>
   DIALOG_DEV_BOARD__
   |                 |            UART&lt;-&gt;USB_CONVERTER__              PC___________
   |       UART2_____|           |                      |            |             |
   |       | TX(P4_1)|----------&gt;|RX      FT232      USB|&lt;----------&gt;|USB          |
   |       | RX(P4_2)|&lt;----------|TX                 GND|            |             |
   |       `---------|           '----------------------'            |   TERMINAL  |
   |                 |                                |              |  |        | |
   |              GND|--------------------------------'              |  '--------' |
   '-----------------'                                               '-------------'
</pre><ul>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_UART        (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C     (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_ADXL362 (0)</span></div>
</div><!-- fragment --> and functional conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_POWER_MODE     (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>UART2 user 1</h5>
<p>Enable a user 1 on UART2 - this will be printing a message on the UART2 from the user every second.</p>
<h5>UART2 user 2</h5>
<p>Enable a user 2 on UART2 - this will be printing a message on the UART2 from the user 2 every half of a second.</p>
<h5>Lock UART2 for user X</h5>
<p>Lock the UART2 for the user 1 or the user 2, then only one user may use UART2, the second user is blocked.</p>
<h5>Prompt from user X</h5>
<p>Stop printing messages from users and wait for typing message from the selected user (X).</p>
<h4>UART demo with concurrent access and queues</h4>
<ul>
<li><b>Demonstrated peripheral</b>: UART</li>
<li><b>Source file</b>: demo_uart_printf.c</li>
<li><b>Description:</b> <br />
 The demo presents an example of printf-like calls which can be used to output data from the application over the UART2. It uses resource locking to properly handle concurrent access from different tasks. It uses also queues to implement asynchronous write requests, which is especially useful when called from a ISR.</li>
<li><b>Pin-connections</b>: The same as in 'UART demo with using OS abstraction layer' demo.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_UART        (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI         (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_AD_SPI_I2C     (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_ADXL362 (0)</span></div>
</div><!-- fragment --> and functional conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_POWER_MODE     (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board the same menu as in 'UART demo with using OS abstraction layer' demo should appear.</li>
</ul>
<h4>Wakeup timer</h4>
<ul>
<li><b>Demonstrated peripheral</b>: Wake-up timer</li>
<li><b>Source file</b>: demo_wkup.c</li>
<li><b>Description:</b> <br />
 The demo presents a timer used for capturing external events. It can be used as a wake-up trigger with a programmable number of external events on chosen GPIO and debounce time. After reaching the predetermined amount of events an interrupt is generated.</li>
<li><b>Pin-connections</b>: There is no need to make any additional connections - everything is available on the board.</li>
<li><b>Run steps</b>:<br />
 To enable the demo go to the <b><code>config/default/userconfig.h</code></b> file and set: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_WKUP      (1)</span></div>
</div><!-- fragment --> Following macro has to be disabled due to pin conflicts: <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_POWER_MODE   (0)</span></div>
</div><!-- fragment --> After build and run the demo on the board a menu with the following options should appear. Expected result is described in each menu option below.</li>
</ul>
<h5>Input configuration</h5>
<p>Enable or disable GPIOs used by the wake-up (P3.0, P3.1, P3.2 by default) and set how they should be triggered - high or low state. A wakeup interrupt should be generated in two cases:</p><ul>
<li>Connecting to GND when the GPIO has the low state trigger,</li>
<li>Disconnecting from GND when the GPIO has the high state trigger. When the interrupt is generated, then in the terminal a "Wake up interrupt triggered" notification is shown.</li>
</ul>
<h5>Timer configuration</h5>
<p>Set a threshold and a debounce time.</p>
<p>The threshold determines how many times the state on the GPIO has to be changed to generate the interrupt, e.g. for 5 events the state of the pin is to be changed five times to fire the interrupt (see "Wake up interrupt triggered").</p>
<p>From the moment the trigger is fired for the chosen pin, the wake-up timer counts down every millisecond. When zero is reached, and the key (the GPIO) is still pressed (i.e. has the same state) the event counter will be incremented. After the key is released and pressed once again the above operation will be repeated. The debounce time in this case is the time from which the timer starts counting down. It allows better stabilizing state of the pin. The longer the debounce time the less often the state of the pin is checked.</p>
<h5>Reset timer counter</h5>
<p>The event counter is set to 0.</p>
<h5>Emulate key hit</h5>
<p>In this case the debounce time has to be disabled in a timer configuration. This simply emulates a button pressing action (an additional option instead of using wire and the chosen pin) causing the event counter to be incremented. When the predetermined amount of events is reached then the interrupt is fired.</p>
<h5>Get timer state</h5>
<p>Show active pins - they can be changed in gpio_setup.h. This option also shows the threshold, debounce time and counter values. The counter in this case is not used for counting how many times interrupt was fired but it is used for counting events before the interrupt is generated e.g. for 5 events threshold when state of the pin is changed 3 times then counter should be equal to 3. When interrupt is fired then counter is reset and his value equals 0.</p>
<p>The following configurations on wake-up timer are used in this example:</p><ul>
<li>Threshold counter: get/set the amount of events after that interrupt is generated</li>
<li>Debounce time: time after each state of a key press/release is checked</li>
<li>Trigger: set pins that triggers the wake-up and increments the counter. It can be triggered by low or high state of the pin (depends of settings)</li>
</ul>
<h2>Installation procedure</h2>
<p>The project is located in the <b><code>projects/dk_apps/demos/peripherals_demo</code></b> folder.</p>
<p>To install the project follow the <a class="el" href="install_and_debug_procedure.html">General Installation and Debugging Procedure</a>.</p>
<h2>Suggested Configurable parameters</h2>
<p>Suggested configurable parameters are localized in the <code>config/default/userconfig.h</code> file. When changing configuration is needed, it is recommended to copy that file to <code>config/userconfig.h</code> and make changes there - it will be used instead of the previous one.</p>
<h3>Selecting demos</h3>
<p>In <code>userconfig.h</code> there are a lot of demo #defines (macros) like e.g </p><div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_HW_TIMER2      (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_WKUP        (1)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_HW_BREATH      (0)</span></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BH1750  (0)</span></div>
<div class="line"><span class="preprocessor">#define CFG_DEMO_SENSOR_BME280  (1)</span></div>
</div><!-- fragment --><p> if macro has (0) value then it is inactive, if (1) it is active but keep in mind that there is no possibility to run all demos simultaneously!</p>
<h3>End of line</h3>
<p>In <code>userconfig.h</code> it is also possible to set the <b>CFG_UART_USE_CRLF</b> flag which defines a newline sequence. If it is set to 1, "\r\n" is used as the newline sequence, otherwise "\n". It supports terminals which do not handle properly a "\n" endline sign.</p>
<h3>GPIO assignments</h3>
<p>It is recommended to copy the <code>gpio_setup.h</code> file to <code>config/gpio_setup.h</code> and make changes there. Peripheral defines can be set with HW_GPIO_PORT_x and HW_GPIO_PIN_x e.g.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define CFG_GPIO_IR_PORT                (HW_GPIO_PORT_3)</span></div>
<div class="line"><span class="preprocessor">#define CFG_GPIO_IR_PIN                 (HW_GPIO_PIN_7)</span></div>
</div><!-- fragment --><p>This configures port 3 with pin 7 as GPIO for IR generator.</p>
<h2>Manual testing</h2>
<p>Select from the text-based menu, in a serial terminal, the demo which is to be tested. Configure a peripheral (optional) and run the proper action. Check if performed action is consistent with the description and specification.</p>
<h2>Known limitations</h2>
<p>The correct flag in the <code>userconfig.h</code> file has to be chosen carefully, keeping in mind that not all combinations are allowed due to memory and GPIO restrictions. Therefore correct demos should be chosen or GPIO configuration should be adjusted to build the project. As a result it has to be remembered that:</p>
<ul>
<li>To enable I2C, I2C_async or I2C sensors demo the Timer2, GPADC and GPADC adapter demos have to be disabled (they use the same GPIOs).</li>
<li>To enable demos which use SPI interface, Breath, Timer2, QUAD and UART demos have to be disabled.</li>
<li>To enable the QUAD demo, the UART demo should be disabled.</li>
<li>Timer2 can't be run simultaneously with ADXL362 sensor demo.</li>
<li>UART, I2C demos require bigger than the standard stack size which applies to the amount limitations of running demos (the best way is to run the demos when other demos are shut down, but there is also a possibility to run them with selecting demos which do not cause stack overflow).</li>
</ul>
<p>The best way is to use one demo, check how it works, turn it off and turn on another one but it is not a demand.</p>
<p>Some demos require external devices e.g:</p>
<ul>
<li>Sensors' demos need the sensor board (DA14680_Sensor_Board),</li>
<li>I2C and I2C async demos require FM75 and EEPROM memory devices which must be connected to the I2C interface,</li>
<li>SPI demo, SPI and I2C demo require AT45DB011D (FLASH memory) and 24xx256 (EEPROM memory) which must be connected externally - they are not placed on the development board.</li>
<li>UART demo requires UART&lt;-&gt;USB converter e.g. FT232. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 19 2018 07:50:05 for SmartSnippets DA1468x/DA15xxx SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
